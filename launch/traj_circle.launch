<launch>

  <!-- Trajectory Publisher: Circle -->
  <node pkg="mpc_offboard"
        type="trajectory_publisher_mavros_gated.py"
        name="px4_trajectory_publisher_gated"
        output="screen">

    <!-- Mode & umum -->
    <param name="waypoint_mode"          value="circle" />
    <param name="ref_speed"              value="2.0" />
    <param name="loop_trajectory"        value="false" />   <!-- terus muter -->
    <param name="start_at_current_pose"  value="true" />

    <!-- Hover & altitude gate -->
    <param name="hover_altitude"         value="5.0" />
    <param name="alt_tolerance"          value="0.3" />
    <param name="hover_stable_time"      value="1.0" />
    <param name="gate_on_altitude"       value="true" />

    <!-- Circle params -->
    <param name="circle_center_n"        value="0.0" />
    <param name="circle_center_e"        value="0.0" />
    <!-- radius kira-kira sama order dengan square -->
    <param name="circle_radius"          value="7.5" />
    <!-- alt di NED, nanti di-anchor ke -hover_altitude saat start_at_current_pose=true -->
    <param name="circle_altitude"        value="-5.0" />
    <!-- titik dense sepanjang lingkaran -->
    <param name="circle_points"          value="80" />

    <!-- Circle: pure trajectory tracking (bukan waypoint-follow) -->
    <param name="waypoint_follow_mode"   value="false" />
    <param name="acceptance_radius_xy"   value="0.8" />
    <param name="acceptance_alt_tol"     value="0.5" />
    <param name="advance_on_reach"       value="false" />
  </node>

  <!-- ==== NODE 2: MPC TRAJECTORY FOLLOWER MANUAL ==== -->
  <node name="mpc_trajectory_follower_manual"
        pkg="mpc_offboard"
        type="mpc_trajectory_follower_manual.py"
        output="screen">
  </node>

  <!-- ==== NODE 3: DATA LOGGER MAVROS TRAJ ==== -->
  <node name="data_logger_mavros_traj"
        pkg="mpc_offboard"
        type="data_logger_mavros_traj.py"
        output="screen">
    <!-- Auto stop saat trajectory selesai -->
    <param name="auto_stop_on_finish" value="true"/>
  </node>

</launch>
